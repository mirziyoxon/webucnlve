<!doctype html>
<html lang="en">
<head>
  <script>
    (() => {
  // O'zingiz ruxsat bermoqchi bo'lgan davlatlar (ISO 2-harf kodlari)
  const allowedCountries = ['UZ', 'KG', 'KZ']; // misol: O'zbekiston, Qirg'iziston, Qozog'iston

  // Geo API (bepul/limitli — o'zgartiring agar sizda API kaliti bo'lsa)
  const GEO_API = 'https://ipapi.co/json/';

  // Dastlab sahifa ko'rinishini yashiramiz — flashni oldini olish uchun
  try { document.documentElement.style.visibility = 'hidden'; } catch(e){}

  // Ko'rsatish uchun fallback vaqt (ms)
  const FALLBACK_SHOW_MS = 4000;

  // Deny sahifasi HTML (o'zgartiring)
  const DENIED_HTML = `
    <div style="height:100vh;display:flex;align-items:center;justify-content:center;flex-direction:column;font-family:Arial,Helvetica,sans-serif;text-align:center;padding:24px;">
      <h1 style="margin:0 0 12px 0;">Uzr — sayt sizning davlatingizda mavjud emas</h1>
      <p style="margin:0 0 18px 0;">Agar siz admin bo'lsangiz yoki bu xato deb o'ylasangiz, VPN yoki qo'llab-quvvatlash bilan bog'laning.</p>
      <button id="gc_retry" style="padding:10px 14px;border-radius:6px;border:0;background:#0d6efd;color:#fff;cursor:pointer;">Qayta tekshirish</button>
    </div>
  `;

  // Foydalanuvchiga sahifani ko'rsatish
  function showPage() {
    document.documentElement.style.visibility = '';
  }

  // Deny qilish
  function deny(msg) {
    document.documentElement.innerHTML = DENIED_HTML;
    // Retry tugmasi
    const b = document.getElementById('gc_retry');
    if(b) b.addEventListener('click', () => {
      // qayta yuklash va yana tekshirish
      location.reload();
    });
  }

  // Asosiy tekshiruv
  (async () => {
    // Local / dev hostlarga ruxsat (agar xohlasangiz true qoldiring)
    if(location.hostname === 'localhost' || location.hostname === '127.0.0.1' || location.protocol === 'file:') {
      showPage();
      return;
    }

    // Geo API so'rovi
    let timedOut = false;
    const timeoutId = setTimeout(() => { timedOut = true; showPage(); }, FALLBACK_SHOW_MS);

    try {
      const res = await fetch(GEO_API, { cache: 'no-store' });
      clearTimeout(timeoutId);
      if(!res.ok) {
        // API javob bermasa: xavfsizlik uchun DENY qilamiz (xohlasangiz showPage() qilavering)
        deny('Geolocation xizmatiga ulanib bo‘lmadi.');
        return;
      }
      const data = await res.json();
      // ipapi bilan ishlaganda country yoki country_code bo'lishi mumkin
      const iso = (data.country || data.country_code || '').toString().toUpperCase();

      if(allowedCountries.includes(iso)){
        showPage();
      } else {
        deny('Sizning davlatingizga ruxsat yo‘q.');
      }
    } catch (err) {
      clearTimeout(timeoutId);
      // Xatolik bo'lsa — xavfsizlik uchun deny (agar istasangiz showPage() qilib qo'ying)
      console.error('Geo check error', err);
      deny('Geo tekshiruvida xato.');
    }
  })();
})();
  </script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Unicorner Live — Broadcast</title>
  <style>
    :root{--bg:#ffffff;--page:#f8fbff;--card:#ffffff;--text:#0b1724;--muted:#6b7280;--accent:#0077cc}
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; background:var(--bg); color:var(--text)}
    .wrap{max-width:1200px;margin:28px auto;padding:18px}
    header{display:flex;align-items:center;justify-content:space-between;gap:16px}
    .logo{width:48px;height:48px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#4fb3ff);display:flex;align-items:center;justify-content:center;font-weight:700;color:#fff}
    h1{font-size:20px;margin:0}
    p.lead{color:var(--muted);margin:4px 0 0;font-size:13px}

    .clock{color:var(--muted);font-size:14px;display:flex;flex-direction:column;align-items:flex-end}
    .clock span{font-weight:600;color:var(--text)}

    .grid{display:grid;grid-template-columns:2fr 1fr;gap:20px;margin-top:18px}
    @media (max-width:900px){.grid{grid-template-columns:1fr}}

    .card{background:var(--card);border-radius:12px;padding:14px;box-shadow:0 6px 18px rgba(11,23,36,0.06);border:1px solid rgba(11,23,36,0.04)}
    .video-wrap{position:relative;padding-top:56.25%;border-radius:10px;overflow:hidden;background:#000}
    .video-wrap iframe{position:absolute;inset:0;width:100%;height:100%;border:0}

    .meta{display:flex;align-items:center;justify-content:space-between;margin-top:12px;flex-wrap:wrap;gap:10px}
    .meta .left{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    .btn{background:transparent;border:1px solid rgba(11,23,36,0.06);padding:8px 12px;border-radius:10px;color:var(--text);cursor:pointer}
    .btn.primary{background:var(--accent);color:#fff;border:0}

    .muted{color:var(--muted);font-size:13px}
    .pill{display:inline-block;padding:6px 10px;border-radius:999px;background:rgba(0,0,0,0.02);font-size:13px}

    .speakers, .partners{margin-bottom:20px}
    .speakers h2, .partners h2{font-size:16px;margin-bottom:10px;color:var(--text)}
    .speaker{display:flex;align-items:center;gap:12px;margin-bottom:12px}
    .speaker img{width:48px;height:48px;border-radius:50%;object-fit:cover}
    .speaker div{display:flex;flex-direction:column}
    .speaker strong{font-size:14px}
    .speaker span{font-size:12px;color:var(--muted)}

    .partners-logos{display:flex;flex-wrap:wrap;gap:12px}
    .partners-logos img{height:32px;object-fit:contain;filter:grayscale(100%);transition:.3s}
    .partners-logos img:hover{filter:none}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div style="display:flex;align-items:center;gap:16px">
        <div class="logo">U</div>
        <div>
          <h1>UnicornerLIVE - Broadcast</h1>
          <p class="lead">Embed your Unlisted YouTube Live easily. <span class="muted">(Replace VIDEO_ID)</span></p>
        </div>
      </div>
      <div class="clock">
        <div>Local time:</div>
        <span id="localClock">--:--</span>
      </div>
    </header>

    <main class="grid">
      <section class="card">
        <div class="video-wrap" id="videoContainer">
          <iframe id="ytPlayer" 
  src="https://www.youtube.com/embed/xEgRTpM6Q4k?autoplay=0&modestbranding=1&rel=0" 
  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
  allowfullscreen 
  title="Unicorner Live"></iframe>
        </div>

        <div class="meta">
          <div class="left">
            <div class="pill">Live: <strong id="liveState">ready</strong></div>
            <div class="muted">| Host: <strong>Unicorner Team</strong></div>
          </div>
          <div>
            <button class="btn" id="openYt">Open on YouTube</button>
          </div>
        </div>

        <div style="margin-top:12px;display:flex;gap:10px;flex-wrap:wrap">
          <div class="muted">Broadcast time: <strong id="startTime">—</strong></div>
          <div class="muted">Channel: <strong id="channelName">—</strong></div>
        </div>
      </section>

      <aside>
        <div class="speakers card">
          <h2>Speakers</h2>
          <div class="speaker">
            <img src="speaker1.jpg" alt="Speaker 1">
            <div>
              <strong>Abduqodirjon Bakhromov</strong>
              <span>Interviewer @ UGS Tashkent</span>
            </div>
          </div>
          <div class="speaker">
            <img src="speaker2.jpg" alt="Speaker 2">
            <div>
              <strong>John Smith</strong>
              <span>CTO, Company Y</span>
            </div>
          </div>
        </div>

        <div class="partners card">
          <h2>Partners & Sponsors</h2>
          <div class="partners-logos">
            <a href="#"><img src="partner1.png" alt="Partner 1"></a>
            <a href="#"><img src="partner2.png" alt="Partner 2"></a>
            <a href="#"><img src="partner3.png" alt="Partner 3"></a>
          </div>
        </div>
      </aside>
    </main>
  </div>

  <script>
    const VIDEO_ID = 'xEgRTpM6Q4k';
    document.getElementById('openYt').addEventListener('click', ()=>{
      window.open('https://youtu.be/xEgRTpM6Q4k?feature=shared' + VIDEO_ID, '_blank');
    });

    // Local clock
    function updateClock(){
      const now = new Date();
      document.getElementById('localClock').textContent = now.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
    }
    setInterval(updateClock, 1000);
    updateClock();

    // Broadcast start time (UTC -> local)
    const UTC_START_ISO = '2025-09-28T14:00:00Z';
    function updateStartTime(){
      const startUtc = new Date(UTC_START_ISO);
      if(isNaN(startUtc)){
        document.getElementById('startTime').textContent = 'TBD';
        return;
      }
      const localStr = startUtc.toLocaleString([], {year:'numeric', month:'short', day:'numeric', hour:'2-digit', minute:'2-digit'});
      document.getElementById('startTime').textContent = localStr;
    }
    updateStartTime();
  </script>
</body>
</html>
